<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <title>ResQ 112 - Profile</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Exo+2:wght@400;700;900&family=Space+Grotesk:wght@400;600;700&display=swap" rel="stylesheet" />
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
  <style>
    :root {
        --bg-color: #000000;
        --text-color: #e0e0e0;
        --text-color-light: #fff;
        --text-highlight-glow: #00ffff;
        --glass-card-bg: rgba(255,255,255,0.05);
        --glass-card-border: rgba(255,255,255,0.1);
        --header-bg: rgba(0,0,0,0.3);
        --primary-font: 'Exo 2', sans-serif;
        --secondary-font: 'Space Grotesk', sans-serif;
    }
    body.light-theme {
        --bg-color: #eaf2f8;
        --text-color: #34495e;
        --text-color-light: #1c2833;
        --text-highlight-glow: #0056b3;
        --glass-card-bg: rgba(255,255,255,0.6);
        --glass-card-border: rgba(220,220,220,0.8);
        --header-bg: rgba(255,255,255,0.2);
    }
    body {
        font-family: var(--secondary-font);
        background-color: var(--bg-color);
        color: var(--text-color);
        transition: background-color 0.5s ease, color 0.5s ease;
        overflow-x:hidden;
    }
    #ripple-canvas{position:fixed;top:0;left:0;width:100%;height:100%;z-index:0}
    .content-overlay{position:relative;z-index:2;min-height:100vh;}
    header { background-color: var(--header-bg); }
    .logo-container span { font-family: var(--secondary-font); color: var(--text-color-light); }
    .glass-card{
        background:var(--glass-card-bg); backdrop-filter:blur(10px); border:1px solid var(--glass-card-border);
        padding:24px; border-radius:16px; transition:all .3s ease; color: var(--text-color);
    }
    .glass-card:hover{box-shadow:0 0 10px var(--text-highlight-glow),0 0 25px var(--text-highlight-glow);}
    .glow-button{
        display:inline-block; padding:12px 24px; border-radius:8px; background:var(--text-highlight-glow);
        color:black; font-weight:600; text-align:center; transition:all .3s ease; border: 1px solid var(--text-highlight-glow);
    }
    body.light-theme .glow-button { color: white; }
    .glow-button:hover{box-shadow:0 0 10px var(--text-highlight-glow),0 0 25px var(--text-highlight-glow);}
    .back-button{background:rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2);}
    .back-button:hover{background:rgba(255,255,255,0.2);}
    #theme-switcher {
        background: none; border: 1px solid var(--glass-card-border); border-radius: 50%; width: 40px; height: 40px;
        cursor: pointer; display: flex; align-items: center; justify-content: center; padding: 8px; color: var(--text-color-light);
    }
    .sun-icon { display: none; }
    body.light-theme .moon-icon { display: none; }
    body.light-theme .sun-icon { display: block; }
  </style>
  <script>
    (function() {
        const currentTheme = localStorage.getItem('theme');
        if (currentTheme === 'light') { document.body.classList.add('light-theme'); }
    })();
  </script>
</head>
<body>
<canvas id="ripple-canvas"></canvas>

<div class="content-overlay flex flex-col min-h-screen">
  <header class="p-4 flex justify-between items-center">
    <div class="flex items-center space-x-4 logo-container">
      <img src="logo.png.png" alt="logo" class="h-12 w-12"/>
      <span class="text-2xl font-bold">ResQ 112</span>
    </div>
    <div class="flex items-center gap-4">
        <select id="languageSwitcher" class="bg-black/50 text-white p-2 rounded border border-gray-700">
            <option value="en">English</option>
            <option value="hi">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</option>
            <option value="as">‡¶Ö‡¶∏‡¶Æ‡ßÄ‡¶Ø‡¶º‡¶æ</option>
        </select>
        <button id="theme-switcher" title="Toggle theme">
            <svg class="moon-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2.25a.75.75 0 01.75.75v2.25a.75.75 0 01-1.5 0V3a.75.75 0 01.75-.75zM7.5 12a4.5 4.5 0 119 0 4.5 4.5 0 01-9 0zM18.894 6.106a.75.75 0 010 1.06l-1.591 1.59a.75.75 0 11-1.06-1.06l1.59-1.591a.75.75 0 011.06 0zM21.75 12a.75.75 0 01-.75.75h-2.25a.75.75 0 010-1.5H21a.75.75 0 01.75.75zM17.894 17.894a.75.75 0 011.06 0l1.59 1.591a.75.75 0 11-1.06 1.06l-1.591-1.59a.75.75 0 010-1.06zM12 21a.75.75 0 01.75.75v2.25a.75.75 0 01-1.5 0v-2.25A.75.75 0 0112 21zM5.106 17.894a.75.75 0 010-1.06l1.591-1.59a.75.75 0 111.06 1.06l-1.59 1.591a.75.75 0 01-1.06 0zM3 12a.75.75 0 01.75-.75h2.25a.75.75 0 010 1.5H3.75A.75.75 0 013 12zM6.106 5.106a.75.75 0 011.06 0l1.59 1.591a.75.75 0 11-1.06 1.06l-1.591-1.59a.75.75 0 010-1.06z"></path></svg>
            <svg class="sun-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 01.162.819A8.97 8.97 0 009 6a9 9 0 009 9 8.97 8.97 0 003.463-.69.75.75 0 01.981.98 10.503 10.503 0 01-9.694 6.46c-5.799 0-10.5-4.701-10.5-10.5 0-3.51 1.713-6.625 4.43-8.56a.75.75 0 01.818.162z" clip-rule="evenodd"></path></svg>
        </button>
    </div>
  </header>

  <main class="container mx-auto px-4 mt-12 flex-grow flex flex-col items-center justify-center">
    <div class="w-full max-w-4xl flex flex-col md:flex-row gap-8 items-center">
      <div class="flex-shrink-0 flex justify-center">
        <img src="qr.png" alt="QR Code" class="w-52 h-52 md:w-64 md-h-64 rounded-lg shadow-lg border-2 p-2" style="border-color: var(--text-highlight-glow)"/>
      </div>

      <div class="flex-grow glass-card w-full">
        <h2 class="text-2xl font-bold mb-6" data-i18n="profile_title" style="color: var(--text-highlight-glow);">üë§ User Profile</h2>
        <div class="space-y-3 text-lg">
          <p><b data-i18n="label_name" style="color: var(--text-color-light);">Name:</b> <span id="userName" class="ml-2">‚Äî</span></p>
          <p><b data-i18n="label_id" style="color: var(--text-color-light);">ID:</b> <span id="userId" class="ml-2">‚Äî</span></p>
          <p><b data-i18n="label_method" style="color: var(--text-color-light);">Method:</b> <span id="userMethod" class="ml-2">‚Äî</span></p>
          <p><b data-i18n="label_blockchain" style="color: var(--text-color-light);">Blockchain ID:</b> <span id="blockchainId" class="ml-2 text-sm break-all">‚Äî</span></p>
        </div>
      </div>
    </div>
    <a href="dashboard.html" class="glow-button back-button mt-12" data-i18n="back_button">
        Back to Dashboard
    </a>
  </main>
</div>

<script src="profile.js?v=1.1"></script>
<script>
// --- THEME SWITCHER LOGIC ---
const themeSwitcher = document.getElementById('theme-switcher');
themeSwitcher.addEventListener('click', () => {
    document.body.classList.toggle('light-theme');
    const currentTheme = document.body.classList.contains('light-theme') ? 'light' : 'dark';
    localStorage.setItem('theme', currentTheme);
});
// Firebase Config
const firebaseConfig = {
  apiKey: "AIzaSyBcLtaRPt6hTo4aEFRvcBwNq5-00soEjB4", authDomain: "sos-c1499.firebaseapp.com",
  databaseURL: "https://sos-c1499-default-rtdb.asia-southeast1.firebasedatabase.app", projectId: "sos-c1499",
  storageBucket: "sos-c1499.firebasestorage.app", messagingSenderId: "1008729495848",
  appId: "1:1008729495848:web:7d6c7d3a6047e2736e981d", measurementId: "G-JGBY3ZZPGC"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();
// Translations
const translations = {
  en: { profile_title: "üë§ User Profile", label_name: "Name:", label_id: "ID:", label_method: "Method:", label_blockchain: "Blockchain ID:", back_button: "Back to Dashboard" },
  hi: { profile_title: "üë§ ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§™‡•ç‡§∞‡•ã‡§´‡§º‡§æ‡§á‡§≤", label_name: "‡§®‡§æ‡§Æ:", label_id: "‡§Ü‡§à‡§°‡•Ä:", label_method: "‡§µ‡§ø‡§ß‡§ø:", label_blockchain: "‡§¨‡•ç‡§≤‡•â‡§ï‡§ö‡•á‡§® ‡§Ü‡§à‡§°‡•Ä:", back_button: "‡§°‡•à‡§∂‡§¨‡•ã‡§∞‡•ç‡§° ‡§™‡§∞ ‡§µ‡§æ‡§™‡§∏ ‡§ú‡§æ‡§è‡§Ç" },
  as: { profile_title: "üë§ ‡¶¨‡ßç‡¶Ø‡ß±‡¶π‡¶æ‡ß∞‡¶ï‡¶æ‡ß∞‡ßÄ‡ß∞ ‡¶™‡ßç‡ß∞‡¶´‡¶æ‡¶á‡¶≤", label_name: "‡¶®‡¶æ‡¶Æ:", label_id: "‡¶Ü‡¶á‡¶°‡¶ø:", label_method: "‡¶™‡¶¶‡ßç‡¶ß‡¶§‡¶ø:", label_blockchain: "‡¶¨‡ßç‡¶≤‡¶ï‡¶ö‡ßá‡¶á‡¶® ‡¶Ü‡¶á‡¶°‡¶ø:", back_button: "‡¶°‡ßá‡¶∂‡ßç‡¶¨‡¶¨‚Äô‡ß∞‡ßç‡¶°‡¶≤‡ßà ‡¶ò‡ßÇ‡ß∞‡¶ø ‡¶Ø‡¶æ‡¶ì‡¶ï" }
};
// Language Switcher Logic
const switcher = document.getElementById("languageSwitcher");
function updateLanguage(lang) {
  localStorage.setItem("lang", lang);
  document.querySelectorAll("[data-i18n]").forEach(el => {
    const key = el.getAttribute("data-i18n");
    if (translations[lang] && translations[lang][key]) { el.innerText = translations[lang][key]; }
  });
}
switcher.addEventListener("change", e => updateLanguage(e.target.value));
// Firebase Data Retrieval
function getUserId() { return localStorage.getItem("userId") || localStorage.getItem("id") || localStorage.getItem("aadhar") || localStorage.getItem("passport"); }
const uid = getUserId();
if (uid) {
  db.ref("users/" + uid).once("value").then(snap => {
    const data = snap.val();
    if (data) {
      document.getElementById("userName").innerText = data.name || "‚Äî";
      document.getElementById("userId").innerText = data.id || "‚Äî";
      document.getElementById("userMethod").innerText = data.method || "‚Äî";
      let bid = data.blockchainId;
      if (!bid) {
        bid = "BCID-" + Math.random().toString(36).substring(2, 12).toUpperCase();
        db.ref("users/" + uid + "/blockchainId").set(bid);
      }
      document.getElementById("blockchainId").innerText = bid;
    } else { console.warn("No user data found for ID:", uid); }
  }).catch(error => { console.error("Firebase read failed:", error); });
} else { console.error("No user ID found to fetch profile."); }
// Initial Load Actions
window.addEventListener("load", () => {
  const savedLang = localStorage.getItem("lang") || "en";
  switcher.value = savedLang; updateLanguage(savedLang);
});
// Ripple background
const canvas=document.getElementById("ripple-canvas"),ctx=canvas.getContext("2d");
canvas.width=innerWidth;canvas.height=innerHeight; let ripples=[];
class Ripple{constructor(x,y){this.x=x;this.y=y;this.radius=0;this.alpha=1;}
update(){this.radius+=1.5;this.alpha-=0.01;}
draw(){ctx.beginPath();ctx.arc(this.x,this.y,this.radius,0,2*Math.PI);ctx.strokeStyle=`rgba(0,255,255,${this.alpha})`;ctx.stroke();}}
function animate(){ctx.clearRect(0,0,canvas.width,canvas.height);
ripples.forEach((r,i)=>{r.update();r.draw();if(r.alpha<=0)ripples.splice(i,1);});
requestAnimationFrame(animate);}
animate();
addEventListener("mousemove",e=>ripples.push(new Ripple(e.clientX,e.clientY)));
addEventListener("resize",()=>{canvas.width=innerWidth;canvas.height=innerHeight});
</script>
</body>
</html>
